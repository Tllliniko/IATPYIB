# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö DNS —Ç—Ä–∞—Ñ–∏–∫–∞
tolmachevniki04@yandex.ru

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

1.  –ü–æ–ª—É—á–∏—Ç—å –∑–Ω–∞–Ω–∏—è –æ –º–µ—Ç–æ–¥–∞—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ä–∞–¥–∏–æ—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∏.
2.  –°–æ—Å—Ç–∞–≤–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ –º–µ—Ö–∞–Ω–∏–∑–º–∞—Ö —Ä–∞–±–æ—Ç—ã Wi-Fi —Å–µ—Ç–µ–π –Ω–∞ –∫–∞–Ω–∞–ª—å–Ω–æ–º
    –∏ —Å–µ—Ç–µ–≤–æ–º —É—Ä–æ–≤–Ω–µ –º–æ–¥–µ–ª–∏ OSI.
3.  –ó–µ–∫—Ä–µ–ø–∏—Ç—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è R
    –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
4.  –ó–∞–∫—Ä–µ–ø–∏—Ç—å –∑–Ω–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã
    tidyverse —è–∑—ã–∫–∞ R

## –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

1.  –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –û–° Windows 11 Pro
2.  RStudio
3.  –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä —è–∑—ã–∫–∞ R 4.5.1

## –®–∞–≥–∏:

1.  –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ.

``` r
library(tidyverse)
```

    Warning: –ø–∞–∫–µ—Ç 'tidyverse' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'ggplot2' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'tibble' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'tidyr' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'readr' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'purrr' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'dplyr' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'forcats' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    Warning: –ø–∞–∫–µ—Ç 'lubridate' –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ R –≤–µ—Ä—Å–∏–∏ 4.5.2

    ‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ
    ‚úî dplyr     1.1.4     ‚úî readr     2.1.6
    ‚úî forcats   1.0.1     ‚úî stringr   1.5.2
    ‚úî ggplot2   4.0.1     ‚úî tibble    3.3.0
    ‚úî lubridate 1.9.4     ‚úî tidyr     1.3.1
    ‚úî purrr     1.2.0     
    ‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
    ‚úñ dplyr::filter() masks stats::filter()
    ‚úñ dplyr::lag()    masks stats::lag()
    ‚Ñπ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(lubridate)
library(stringr)

url <- "https://storage.yandexcloud.net/dataset.ctfsec/P2_wifi_data.csv"

# —á–∏—Ç–∞–µ–º CSV –ø—Ä—è–º–æ –ø–æ —Å—Å—ã–ª–∫–µ
ap_data <- read.csv(
  url,
  header = FALSE,
  stringsAsFactors = FALSE
)
```

1.  –ü—Ä–∏–≤–µ—Å—Ç–∏ –¥–∞—Ç–∞—Å–µ—Ç—ã –≤ –≤–∏–¥ ‚Äú–∞–∫–∫—É—Ä–∞—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö‚Äù, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ç–∏–ø—ã
    —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö.

``` r
client_start_line <- which(ap_data[, 1] == "Station MAC")

ap_data_raw <- ap_data[2:(client_start_line[1]-1), ]
client_data_raw <- ap_data[client_start_line[1]:nrow(ap_data), ]

ap_data_raw <- ap_data_raw[rowSums(is.na(ap_data_raw)) != ncol(ap_data_raw), ]
client_data_raw <- client_data_raw[rowSums(is.na(client_data_raw)) != ncol(client_data_raw), ]
client_data_raw <- client_data_raw[, 1:7]

ap_col_names <- c("BSSID", "First_time_seen", "Last_time_seen", "channel", 
                  "Speed", "Privacy", "Cipher", "Authentication", "Power",
                  "beacons", "IV", "LAN_IP", "ID_length", "ESSID", "Key")

client_col_names <- c("Station_MAC", "First_time_seen", "Last_time_seen", "Power",
                      "packets", "BSSID", "Probed_ESSIDs")

names(ap_data_raw) <- ap_col_names[1:ncol(ap_data_raw)]
names(client_data_raw) <- client_col_names[1:ncol(client_data_raw)]

ap_data_clean <- ap_data_raw %>%
  filter(!is.na(BSSID), BSSID != "", !is.na(ESSID), ESSID != "") %>%
  mutate(
    First_time_seen = as.POSIXct(First_time_seen, format = "%Y-%m-%d %H:%M:%S"),
    Last_time_seen  = as.POSIXct(Last_time_seen,  format = "%Y-%m-%d %H:%M:%S"),
    channel         = as.numeric(channel),
    Speed           = as.numeric(Speed),
    Power           = as.numeric(Power),
    beacons         = as.numeric(beacons),
    IV              = as.numeric(IV),
    ID_length       = as.numeric(ID_length)
  )

client_data_clean <- client_data_raw[-1, ] %>%
  filter(!is.na(Station_MAC), Station_MAC != "", Station_MAC != "Station MAC") %>%
  mutate(
    First_time_seen = as.POSIXct(First_time_seen, format = "%Y-%m-%d %H:%M:%S"),
    Last_time_seen  = as.POSIXct(Last_time_seen,  format = "%Y-%m-%d %H:%M:%S"),
    Power           = as.numeric(Power),
    packets         = as.numeric(packets)
  )
```

1.  –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –æ–±—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ glimpse()

``` r
ap_data_clean %>% glimpse()
```

    Rows: 167
    Columns: 15
    $ BSSID           <chr> "BE:F1:71:D5:17:8B", "6E:C7:EC:16:DA:1A", "9A:75:A8:B9‚Ä¶
    $ First_time_seen <dttm> 2023-07-28 09:13:03, 2023-07-28 09:13:03, 2023-07-28 ‚Ä¶
    $ Last_time_seen  <dttm> 2023-07-28 11:50:50, 2023-07-28 11:55:12, 2023-07-28 ‚Ä¶
    $ channel         <dbl> 1, 1, 1, 7, 6, 6, 11, 11, 11, 1, 6, 14, 11, 11, 6, 6, ‚Ä¶
    $ Speed           <dbl> 195, 130, 360, 360, 130, 130, 195, 130, 130, 195, 180,‚Ä¶
    $ Privacy         <chr> " WPA2", " WPA2", " WPA2", " WPA2", " WPA2", " OPN", "‚Ä¶
    $ Cipher          <chr> " CCMP", " CCMP", " CCMP", " CCMP", " CCMP", " ", " CC‚Ä¶
    $ Authentication  <chr> " PSK", " PSK", " PSK", " PSK", " PSK", "   ", " PSK",‚Ä¶
    $ Power           <dbl> -30, -30, -68, -37, -57, -63, -27, -38, -38, -66, -42,‚Ä¶
    $ beacons         <dbl> 846, 750, 694, 510, 647, 251, 1647, 1251, 704, 617, 13‚Ä¶
    $ IV              <dbl> 504, 116, 26, 21, 6, 3430, 80, 11, 0, 0, 86, 0, 0, 0, ‚Ä¶
    $ LAN_IP          <chr> "   0.  0.  0.  0", "   0.  0.  0.  0", "   0.  0.  0.‚Ä¶
    $ ID_length       <dbl> 12, 4, 2, 14, 25, 13, 12, 13, 24, 12, 10, 0, 24, 24, 1‚Ä¶
    $ ESSID           <chr> " C322U13 3965", " Cnet", " KC", " POCO X5 Pro 5G", " ‚Ä¶
    $ Key             <chr> " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ",‚Ä¶

``` r
client_data_clean %>% glimpse()
```

    Rows: 12,081
    Columns: 7
    $ Station_MAC     <chr> "CA:66:3B:8F:56:DD", "96:35:2D:3D:85:E6", "5C:3A:45:9E‚Ä¶
    $ First_time_seen <dttm> 2023-07-28 09:13:03, 2023-07-28 09:13:03, 2023-07-28 ‚Ä¶
    $ Last_time_seen  <dttm> 2023-07-28 10:59:44, 2023-07-28 09:13:03, 2023-07-28 ‚Ä¶
    $ Power           <dbl> -33, -65, -39, -61, -53, -43, -31, -71, -74, -65, -45,‚Ä¶
    $ packets         <dbl> 858, 4, 432, 958, 1, 344, 163, 3, 115, 437, 265, 77, 7‚Ä¶
    $ BSSID           <chr> " BE:F1:71:D5:17:8B", " (not associated) ", " BE:F1:71‚Ä¶
    $ Probed_ESSIDs   <chr> "C322U13 3965", "IT2 Wireless", "C322U21 0566", "C322U‚Ä¶

### 4. –ê–Ω–∞–ª–∏–∑ —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞.

4.1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ (–±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è ‚Äì OPN).

``` r
insecure_ap <- ap_data_clean %>%
  filter(Privacy == "OPN") %>%
  arrange(desc(Power)) %>%
  select(BSSID, ESSID, Privacy, Power, channel)

total_aps <- nrow(ap_data_clean)
n_insecure <- nrow(insecure_ap)

if (n_insecure > 0) {
  print(insecure_ap)
  cat("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞:", n_insecure, "\n")
  cat("–î–æ–ª—è –æ—Ç –≤—Å–µ—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö:",
      round(100 * n_insecure / total_aps, 1), "%\n")
} else {
  cat("–¢–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (OPN) –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.\n")
}
```

    –¢–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (OPN) –Ω–µ –Ω–∞–π–¥–µ–Ω–æ.

4.2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

``` r
ap_with_manufacturer <- ap_data_clean %>%
  mutate(
    OUI = stringr::str_to_upper(stringr::str_sub(BSSID, 1, 8))
  )

manufacturer_summary <- ap_with_manufacturer %>%
  count(OUI, sort = TRUE, name = "ap_count")

print(head(manufacturer_summary, 10))
```

            OUI ap_count
    1  E8:28:C1       45
    2  E0:D9:E3        9
    3  00:23:EB        7
    4  00:26:99        7
    5  38:1A:52        6
    6  9E:A3:A9        3
    7  A6:02:B9        3
    8  BE:F1:71        3
    9  00:03:7A        2
    10 00:03:7F        2

``` r
cat(
  "–í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π:",
  n_distinct(ap_with_manufacturer$OUI, na.rm = TRUE), "\n"
)
```

    –í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π: 89 

4.3. –í—ã—è–≤–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–µ –ø–æ—Å–ª–µ–¥–Ω—é—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è WPA3, –∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞ —ç—Ç–∏—Ö
—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö.

``` r
wpa3_devices <- ap_data_clean %>%
  mutate(
    Privacy_up = toupper(coalesce(Privacy, "")),
    Auth_up    = toupper(coalesce(Authentication, "")),
    Cipher_up  = toupper(coalesce(Cipher, ""))
  ) %>%
  filter(
    str_detect(Privacy_up, "WPA3") |
      str_detect(Auth_up, "WPA3")  |
      str_detect(Cipher_up, "WPA3")
  ) %>%
  arrange(desc(Power)) %>%
  select(BSSID, ESSID, Privacy, Authentication, Cipher, Power)

if (nrow(wpa3_devices) > 0) {
  print(wpa3_devices)
  cat("–í—Å–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å WPA3:", nrow(wpa3_devices), "\n")
} else {
  cat("–£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WPA3 –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã.\n")
}
```

                  BSSID               ESSID    Privacy Authentication Cipher Power
    1 76:C5:A0:70:08:96                      WPA3 WPA2        SAE PSK   CCMP   -52
    2 BE:FD:EF:18:92:44            –î–∏–º–∞—Å–∏–∫   WPA3 WPA2        SAE PSK   CCMP   -64
    3 CE:48:E7:86:4E:33  iPhone (–ê–Ω–∞—Å—Ç–∞—Å–∏—è)  WPA3 WPA2        SAE PSK   CCMP   -65
    4 3A:DA:00:F9:0C:02   iPhone XS Max ü¶äüê±ü¶ä  WPA3 WPA2        SAE PSK   CCMP   -65
    5 8E:1F:94:96:DA:FD  iPhone (–ê–Ω–∞—Å—Ç–∞—Å–∏—è)  WPA3 WPA2        SAE PSK   CCMP   -67
    6 A2:FE:FF:B8:9B:C9          Christie‚Äôs  WPA3 WPA2        SAE PSK   CCMP   -70
    7 26:20:53:0C:98:E8                      WPA3 WPA2        SAE PSK   CCMP   -85
    8 96:FF:FC:91:EF:64                      WPA3 WPA2        SAE PSK   CCMP   -85
    –í—Å–µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Å WPA3: 8 

4.4 –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—É –≤—Ä–µ–º–µ–Ω–∏, –≤ —Ç–µ—á–µ–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ
–æ–Ω–∏ –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –Ω–∞ —Å–≤—è–∑–∏, –ø–æ —É–±—ã–≤–∞–Ω–∏—é.

``` r
ap_sessions <- ap_data_clean %>%
  arrange(BSSID, First_time_seen) %>%
  group_by(BSSID) %>%
  mutate(
    prev_last_seen = lag(Last_time_seen, default = first(First_time_seen)),
    gap_minutes    = as.numeric(difftime(First_time_seen, prev_last_seen, units = "mins")),
    session_id     = cumsum(gap_minutes > 45 | row_number() == 1)
  ) %>%
  group_by(BSSID, session_id) %>%
  summarise(
    ESSID        = first(ESSID),
    session_start = min(First_time_seen),
    session_end   = max(Last_time_seen),
    .groups       = "drop"
  ) %>%
  mutate(
    session_duration_minutes = as.numeric(difftime(session_end, session_start, units = "mins"))
  ) %>%
  arrange(desc(session_duration_minutes)) %>%
  select(BSSID, ESSID, session_start, session_end, session_duration_minutes)

print(head(ap_sessions, 10))
```

    # A tibble: 10 √ó 5
       BSSID    ESSID session_start       session_end         session_duration_min‚Ä¶¬π
       <chr>    <chr> <dttm>              <dttm>                               <dbl>
     1 00:25:0‚Ä¶ " "   2023-07-28 09:13:06 2023-07-28 11:56:21                   163.
     2 E8:28:C‚Ä¶ " MI‚Ä¶ 2023-07-28 09:13:09 2023-07-28 11:56:05                   163.
     3 E8:28:C‚Ä¶ " MI‚Ä¶ 2023-07-28 09:13:03 2023-07-28 11:55:38                   163.
     4 08:3A:2‚Ä¶ " "   2023-07-28 09:13:27 2023-07-28 11:55:53                   162.
     5 6E:C7:E‚Ä¶ " Cn‚Ä¶ 2023-07-28 09:13:03 2023-07-28 11:55:12                   162.
     6 E8:28:C‚Ä¶ " MI‚Ä¶ 2023-07-28 09:13:06 2023-07-28 11:55:12                   162.
     7 48:5B:3‚Ä¶ " "   2023-07-28 09:13:06 2023-07-28 11:55:11                   162.
     8 E8:28:C‚Ä¶ " "   2023-07-28 09:13:06 2023-07-28 11:55:11                   162.
     9 E8:28:C‚Ä¶ " "   2023-07-28 09:13:06 2023-07-28 11:55:10                   162.
    10 8E:55:4‚Ä¶ " Vl‚Ä¶ 2023-07-28 09:13:06 2023-07-28 11:55:09                   162.
    # ‚Ñπ abbreviated name: ¬π‚Äãsession_duration_minutes

``` r
cat(
  "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ —Å–≤—è–∑–∏ (—Å —É—á—ë—Ç–æ–º —Å–µ—Å—Å–∏–π):",
  round(max(ap_sessions$session_duration_minutes, na.rm = TRUE), 1),
  "–º–∏–Ω—É—Ç\n\n"
)
```

    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ —Å–≤—è–∑–∏ (—Å —É—á—ë—Ç–æ–º —Å–µ—Å—Å–∏–π): 163.2 –º–∏–Ω—É—Ç

4.5. –û–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ç–æ–ø-10 —Å–∞–º—ã—Ö –±—ã—Å—Ç—Ä—ã—Ö —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞.

``` r
fastest_ap <- ap_data_clean %>%
  filter(!is.na(Speed), Speed > 0) %>%
  slice_max(order_by = Speed, n = 10, with_ties = FALSE) %>%
  select(BSSID, ESSID, Speed, channel, Power)

print(fastest_ap)
```

                   BSSID               ESSID Speed channel Power
    1  26:20:53:0C:98:E8                       866      44   -85
    2  96:FF:FC:91:EF:64                       866      44   -85
    3  CE:48:E7:86:4E:33  iPhone (–ê–Ω–∞—Å—Ç–∞—Å–∏—è)   866      44   -65
    4  8E:1F:94:96:DA:FD  iPhone (–ê–Ω–∞—Å—Ç–∞—Å–∏—è)   866      44   -67
    5  9A:75:A8:B9:04:1E                  KC   360       1   -68
    6  4A:EC:1E:DB:BF:95      POCO X5 Pro 5G   360       7   -37
    7  56:C5:2B:9F:84:90          OnePlus 6T   360       1   -64
    8  E8:28:C1:DC:B2:41        MIREA_GUESTS   360      48   -89
    9  E8:28:C1:DC:B2:40       MIREA_HOTSPOT   360      48   -88
    10 E8:28:C1:DC:B2:42                       360      48   -87

``` r
cat(
  "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ä–µ–¥–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞:",
  max(fastest_ap$Speed, na.rm = TRUE), "Mbps\n"
)
```

    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Å—Ä–µ–¥–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ç–æ—á–µ–∫ –¥–æ—Å—Ç—É–ø–∞: 866 Mbps

4.6. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–∫–∏ –¥–æ—Å—Ç—É–ø–∞ –ø–æ —á–∞—Å—Ç–æ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (beacons)
–≤ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏ –ø–æ –∏—Ö —É–±—ã–≤–∞–Ω–∏—é.

``` r
beacon_stats <- ap_data_clean %>%
  mutate(
    total_time_hours = as.numeric(difftime(Last_time_seen, First_time_seen, units = "hours")),
    beacon_rate      = if_else(total_time_hours > 0,
                               beacons / total_time_hours,
                               NA_real_)
  ) %>%
  filter(!is.na(beacon_rate), total_time_hours > 0, beacon_rate > 0) %>%
  arrange(desc(beacon_rate)) %>%
  select(BSSID, ESSID, beacons, total_time_hours, beacon_rate, channel)

print(head(beacon_stats, 10))
```

                   BSSID                     ESSID beacons total_time_hours
    1  F2:30:AB:E9:03:ED           iPhone (Uliana)       6     0.0019444444
    2  B2:CF:C0:00:4A:60       –ú–∏—Ö–∞–∏–ª's Galaxy M32       4     0.0013888889
    3  3A:DA:00:F9:0C:02         iPhone XS Max ü¶äüê±ü¶ä       5     0.0025000000
    4  02:BC:15:7E:D5:DC                   MT_FREE       1     0.0005555556
    5  00:3E:1A:5D:14:45                   MT_FREE       1     0.0005555556
    6  76:C5:A0:70:08:96                                 1     0.0005555556
    7  D2:25:91:F6:6C:D8                     –°–∞–Ω—è        5     0.0036111111
    8  BE:F1:71:D6:10:D7              C322U21 0566    1647     2.6280555556
    9  00:03:7A:1A:03:56                   MT_FREE       1     0.0016666667
    10 38:1A:52:0D:84:D7  EBFCD57F-EE81fI_DL_1AO2T     704     1.1997222222
       beacon_rate channel
    1    3085.7143       1
    2    2880.0000       6
    3    2000.0000       6
    4    1800.0000      11
    5    1800.0000      11
    6    1800.0000       6
    7    1384.6154      12
    8     626.6991      11
    9     600.0000      11
    10    586.8025      11

``` r
cat(
  "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ beacon-—Ñ—Ä–µ–π–º–æ–≤:",
  round(max(beacon_stats$beacon_rate, na.rm = TRUE), 1),
  "–≤ —á–∞—Å\n"
)
```

    –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —á–∞—Å—Ç–æ—Ç–∞ beacon-—Ñ—Ä–µ–π–º–æ–≤: 3085.7 –≤ —á–∞—Å

### –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤

1.  –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

``` r
client_with_manufacturer <- client_data_clean %>%
  mutate(
    OUI = stringr::str_to_upper(stringr::str_sub(Station_MAC, 1, 8))
  ) %>%
  select(Station_MAC, OUI, Probed_ESSIDs) %>%
  distinct()

print(head(client_with_manufacturer, 10))
```

             Station_MAC      OUI Probed_ESSIDs
    1  CA:66:3B:8F:56:DD CA:66:3B  C322U13 3965
    2  96:35:2D:3D:85:E6 96:35:2D  IT2 Wireless
    3  5C:3A:45:9E:1A:7B 5C:3A:45  C322U21 0566
    4  C0:E4:34:D8:E7:E5 C0:E4:34  C322U13 3965
    5  5E:8E:A6:5E:34:81 5E:8E:A6              
    6  10:51:07:CB:33:E7 10:51:07              
    7  68:54:5A:40:35:9E 68:54:5A  C322U06 5179
    8  74:4C:A1:70:CE:F7 74:4C:A1              
    9  8A:A3:5A:33:76:57 8A:A3:5A              
    10 CA:54:C4:8B:B5:3A CA:54:C4          GIVC

``` r
cat(
  "–í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤:",
  n_distinct(client_with_manufacturer$OUI), "\n\n"
)
```

    –í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–µ–π –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤: 11792 

2.–û–±–Ω–∞—Ä—É–∂–∏—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –ù–ï —Ä–∞–Ω–¥–æ–º–∏–∑–∏—Ä—É—é—Ç —Å–≤–æ–π MAC –∞–¥—Ä–µ—Å.

``` r
non_randomized <- client_data_clean %>%
  mutate(
    second_char = str_sub(Station_MAC, 2, 2),
    is_randomized = second_char %in% c("2", "6", "a", "e", "A", "E")
  ) %>%
  filter(!is_randomized) %>%
  select(Station_MAC, First_time_seen, Last_time_seen, Power, packets, Probed_ESSIDs) %>%
  arrange(desc(packets))

print(head(non_randomized, 10))
```

             Station_MAC     First_time_seen      Last_time_seen Power packets
    1  00:95:69:E7:7D:21 2023-07-28 09:13:15 2023-07-28 11:56:17   -33    8171
    2  00:95:69:E7:7C:ED 2023-07-28 09:13:11 2023-07-28 11:56:13   -55    4096
    3  00:95:69:E7:7F:35 2023-07-28 09:13:11 2023-07-28 11:56:07   -69    2245
    4  98:F6:21:72:9E:D6 2023-07-28 10:41:15 2023-07-28 11:56:14   -59    2143
    5  C0:E4:34:D8:E7:E5 2023-07-28 09:13:03 2023-07-28 11:53:16   -61     958
    6  74:DF:BF:7B:00:19 2023-07-28 09:45:48 2023-07-28 10:31:11   -65     911
    7  50:3E:AA:33:52:EC 2023-07-28 09:48:25 2023-07-28 11:56:06   -53     862
    8  14:13:33:59:9F:AB 2023-07-28 09:13:12 2023-07-28 10:26:21   -57     849
    9  04:8C:9A:0B:40:EA 2023-07-28 10:27:47 2023-07-28 11:55:51   -73     756
    10 BC:F1:71:D5:0E:53 2023-07-28 09:13:17 2023-07-28 11:50:10   -35     675
           Probed_ESSIDs
    1        nvripcsuite
    2        nvripcsuite
    3        nvripcsuite
    4  Beeline_5G_F2F425
    5       C322U13 3965
    6      MIREA_HOTSPOT
    7                   
    8                   
    9      MIREA_HOTSPOT
    10                  

``` r
cat("–£—Å—Ç—Ä–æ–π—Å—Ç–≤ –±–µ–∑ —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏–∏ MAC:", nrow(non_randomized), "\n")
```

    –£—Å—Ç—Ä–æ–π—Å—Ç–≤ –±–µ–∑ —Ä–∞–Ω–¥–æ–º–∏–∑–∞—Ü–∏–∏ MAC: 220 

``` r
cat("–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞:", round(nrow(non_randomized)/nrow(client_data_clean)*100, 1), "%\n")
```

    –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–≥–æ —á–∏—Å–ª–∞: 1.8 %

1.  –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∫ —Ç–æ—á–∫–∞–º –¥–æ—Å—Ç—É–ø–∞ –ø–æ –∏—Ö –∏–º–µ–Ω–∞–º.
    –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—è–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ –∑–æ–Ω–µ —Ä–∞–¥–∏–æ–≤–∏–¥–∏–º–æ—Å—Ç–∏ –∏ –≤—Ä–µ–º—è
    –≤—ã—Ö–æ–¥–∞ –µ–≥–æ –∏–∑ –Ω–µ–µ.

``` r
signal_stability <- client_data_clean %>% 
  filter(!is.na(Probed_ESSIDs), Probed_ESSIDs != "") %>% 
  group_by(Station_MAC, Probed_ESSIDs) %>% 
  summarise(
    mean_power = mean(Power, na.rm = TRUE),
    sd_power   = sd(Power, na.rm = TRUE),
    n          = n(),
    first_seen = min(First_time_seen),
    last_seen  = max(Last_time_seen),
    .groups    = "drop"
  ) %>% 
  arrange(sd_power)

signal_stability
```

    # A tibble: 1,477 √ó 7
       Station_MAC       Probed_ESSIDs mean_power sd_power     n first_seen         
       <chr>             <chr>              <dbl>    <dbl> <int> <dttm>             
     1 00:90:4C:E6:54:54 Redmi                -65       NA     1 2023-07-28 09:16:59
     2 00:95:69:E7:7C:ED nvripcsuite          -55       NA     1 2023-07-28 09:13:11
     3 00:95:69:E7:7D:21 nvripcsuite          -33       NA     1 2023-07-28 09:13:15
     4 00:95:69:E7:7F:35 nvripcsuite          -69       NA     1 2023-07-28 09:13:11
     5 00:F4:8D:F7:C5:19 Redmi 12             -73       NA     1 2023-07-28 10:45:04
     6 02:00:00:00:00:00 xt3 w64dtgv5‚Ä¶        -67       NA     1 2023-07-28 09:54:40
     7 02:06:2B:A5:0C:31 Avenue611            -65       NA     1 2023-07-28 09:55:12
     8 02:1D:0F:A4:94:74 iPhone (–î–∏–º–∞‚Ä¶        -61       NA     1 2023-07-28 09:57:08
     9 02:32:DC:56:5C:82 Timo Resort          -84       NA     1 2023-07-28 10:58:23
    10 02:35:E9:C2:44:5F iPhone (–ú–∞–∫—Å‚Ä¶        -88       NA     1 2023-07-28 10:00:55
    # ‚Ñπ 1,467 more rows
    # ‚Ñπ 1 more variable: last_seen <dttm>

1.  –û—Ü–µ–Ω–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è —Å–∏–≥–Ω–∞–ª–∞ –≤–Ω—É—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
    –í—ã—è–≤–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä.

``` r
signal_stability <- signal_stability %>%
  mutate(
    stability_score = 1 / (sd_power + 1e-6)
  )

most_stable_cluster <- signal_stability %>%
  arrange(desc(stability_score)) %>%
  slice(1)

most_stable_cluster
```

    # A tibble: 1 √ó 8
      Station_MAC       Probed_ESSIDs mean_power sd_power     n first_seen         
      <chr>             <chr>              <dbl>    <dbl> <int> <dttm>             
    1 00:90:4C:E6:54:54 Redmi                -65       NA     1 2023-07-28 09:16:59
    # ‚Ñπ 2 more variables: last_seen <dttm>, stability_score <dbl>

## –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º—ã –ø–æ–ª—É—á–∏–ª–∏ –∑–Ω–∞–Ω–∏—è –æ –º–µ—Ç–æ–¥–∞—Ö
–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Ä–∞–¥–∏–æ—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –æ–±—Å—Ç–∞–Ω–æ–≤–∫–∏, —Å–æ—Å—Ç–∞–≤–∏–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ
–º–µ—Ö–∞–Ω–∏–∑–º–∞—Ö —Ä–∞–±–æ—Ç—ã Wi-Fi —Å–µ—Ç–µ–π, –∑–∞–∫—Ä–µ–ø–∏–ª–∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–≤—ã–∫–∏
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —è–∑—ã–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è R –∏ –∑–Ω–∞–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
–æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã tidyverse.

## –í—ã–≤–æ–¥

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –æ—Å–≤–æ–∏–ª–∏ –º–µ—Ç–æ–¥—ã –∞–Ω–∞–ª–∏–∑–∞ –∂—É—Ä–Ω–∞–ª–æ–≤ –∏ –∑–∞–∫—Ä–µ–ø–∏–ª–∏ –Ω–∞–≤—ã–∫–∏
—Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–º –ø–∞–∫–µ—Ç–æ–º dplyr.
