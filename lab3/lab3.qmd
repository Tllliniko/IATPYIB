---
title: "Третья практика"
subtitle: "Отчет "
author: "tolmchevnikita04@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Развить практические навыки использования языка программирования R для обработки данных
2. Закрепить знания базовых типов данных языка R
3. Развить практические навыки использования функций обработки данных пакета dplyr – функции select(), filter(), mutate(), arrange(), group_by()

## Исходные данные

1. Rstudio Desktop;
2. Интерпретатор языка R 4.1;
3. Программный пакет `dplyr` и `knitr`.
     
       
 
## План

Проанализировать встроенный в пакет dplyr набор данных `nycflights13` с помощью языка R и ответить на вопросы.   

## Решение:   

1 Установка датафрейма.

```
Устанавливаю пакет в ‘C:/Users/Admin/AppData/Local/R/win-library/4.5’
(потому что ‘lib’ не определено)
устанавливаю также зависимости ‘utf8’, ‘pillar’, ‘pkgconfig’, ‘tibble’
пробую URL 'https://cran.rstudio.com/bin/windows/contrib/4.5/utf8_1.2.6.zip'
пробую URL 'https://cran.rstudio.com/bin/windows/contrib/4.5/pillar_1.11.1.zip'
пробую URL 'https://cran.rstudio.com/bin/windows/contrib/4.5/pkgconfig_2.0.3.zip'
пробую URL 'https://cran.rstudio.com/bin/windows/contrib/4.5/tibble_3.3.0.zip'
пробую URL 'https://cran.rstudio.com/bin/windows/contrib/4.5/nycflights13_1.0.2.zip'
пакет ‘utf8’ успешно распакован, MD5-суммы проверены
пакет ‘pillar’ успешно распакован, MD5-суммы проверены
пакет ‘pkgconfig’ успешно распакован, MD5-суммы проверены
пакет ‘tibble’ успешно распакован, MD5-суммы проверены
пакет ‘nycflights13’ успешно распакован, MD5-суммы проверены

Скачанные бинарные пакеты находятся в
	C:\Users\Admin\AppData\Local\Temp\RtmpyqmN2R\downloaded_packages
```

2 Загрузка библиотек

```{r}
library(dplyr)
library(nycflights13)
library(knitr)
```

3 Сколько встроенных в пакет `nycflights13` датафреймов?

```{r}
data(package = "nycflights13")$results[, "Item"]
```

4 Сколько строк в каждом датафрейме?

```{r}
sapply(ls("package:nycflights13"), function(df) nrow(get(df, "package:nycflights13")))
```

5 Сколько столбцов в каждом датафрейме?

```{r}
sapply(ls("package:nycflights13"), function(df) ncol(get(df, "package:nycflights13")))
```

6 Как просмотреть примерный вид датафрейма?

```{r}
head(airlines)
head(airports)
```

7 Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?

```{r}
length(unique(nycflights13::flights$carrier))
```

8 Сколько рейсов принял аэропорт John F Kennedy Intl в мае?

```{r}
nycflights13::flights %>%
      filter(dest == "JFK", month == 5) %>%
      summarise(flights_count = n())
```

9 Какой самый северный аэропорт?

```{r}
nycflights13::airports %>%
      filter(lat == max(lat, na.rm = TRUE))
```

10 Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?

```{r}
airports %>%
  filter(alt == max(alt, na.rm = TRUE))
```

11 Какие бортовые номера у самых старых самолетов?

```{r}
planes %>%
  filter(!is.na(year)) %>%
  arrange(year) %>%
  select(tailnum, year) %>%
  head(10)
```

12 Какая средняя температура воздуха была в сентябре в аэропорту John F Kennedy Intl (в градусах Цельсия).

```{r}
weather %>%
  filter(origin == "JFK", month == 9) %>%
  summarise(mean_temp_c = (mean(temp, na.rm = TRUE) - 32)* 5/9) %>%
  pull(mean_temp_c)
```

13 Самолеты какой авиакомпании совершили больше всего вылетов в июне?

```{r}
flights %>% left_join(airlines, join_by(carrier)) %>% filter(month == 6)%>%group_by(name) %>% summarise(amount = n()) %>% arrange(desc(amount)) %>% slice(1) %>% select(name, amount) |> knitr::kable(format='markdown')
```

14 Самолеты какой авиакомпании задерживались чаще других в 2013 году?

```{r}
flights %>% left_join(airlines, join_by(carrier)) %>% group_by(name) %>% filter(arr_delay > 0 & year == 2013) %>% summarise(amount = n()) %>% arrange(desc(amount)) %>% slice(1) %>% select(name, amount) |> knitr::kable(format='markdown')
```
## Оценка результата

 В ходе выполнения работы были рассмотрены все компоненты набора данных nycflights13, выполнены операции фильтрации, группировки, сортировки и объединения таблиц. Все вопросы успешно решены.

## Вывод

В результате выполнения лабораторной работы были закреплены навыки обработки данных в R, а также освоены основные функции пакета dplyr. Применение реального набора данных позволило на практике отработать приёмы аналитической обработки таблиц.